#!/usr/bin/perl
# Show all PostgreSQL clusters in a list
#
# (C) 2005 Martin Pitt <mpitt@debian.org>

use lib '/usr/share/postgresql-common';
use PgCommon;

$show_header = 1;

@columns = ('Version', 'Cluster', 'Port', 'Status', 'Owner', 'Data directory',
            'Log file');
@colwidths = qw/8 10 5 7 9 35 30/;

foreach $cw (@colwidths) {
    $fmtstring .= '%-'.$cw.'s';
}
$fmtstring .= "\n";

printf $fmtstring, @columns;

foreach $v (get_versions) {
    foreach $c (get_version_clusters $v) {
        %info = cluster_info $v, $c;
        printf $fmtstring, ($v, $c, $info{'port'}, 
            $info{'running'} ? "online" : "down", 
            (getpwuid $info{'owneruid'})[0], $info{'pgdata'},
            $info{'logfile'});
    }
}

__END__

=head1 NAME

pg_lsclusters - show information about all PostgreSQL clusters

=head1 SYNOPSIS

B<pg_lsclusters>

=head1 DESCRIPTION

This command shows a list about the configuration and status of all clusters.

=head1 AUTHOR

Martin Pitt L<E<lt>mpitt@debian.orgE<gt>>
